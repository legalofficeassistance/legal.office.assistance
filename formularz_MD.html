<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Form – detention data</title>
<style>body{font-family:Arial,sans-serif;background:#f4f4f4;margin:0;padding:0}.container{max-width:800px;margin:20px auto;background:#fff;padding:20px;border-radius:6px}.step{display:none}.step.active{display:block}label{display:block;margin-top:12px;font-weight:bold}input,textarea,select{width:100%;padding:8px;margin-top:4px}textarea{min-height:80px}button{padding:10px 16px;cursor:pointer;margin-top:15px}.box{border:1px solid #ccc;padding:12px;margin-top:15px;border-radius:4px}.progress{height:8px;background:#ddd;border-radius:4px;margin-bottom:20px}.progress-bar{height:8px;background:#4caf50;width:0%;border-radius:4px}.preview{white-space:pre-wrap;background:#f9f9f9;padding:12px}</style>
</head>
<body>
<div class="container">
<div class="progress"><div class="progress-bar" id="progressBar"></div></div>
<form id="form">
<div class="step active"><h2>Personal data</h2>
<label>First name</label><input name="First name">
<label>Last name</label><input name="Last name">
<label>Address</label><textarea name="Address"></textarea></div>
<div class="step"><h2>Contact</h2>
<label>Phone</label><input name="Phone">
<label>Email</label><input type="email" name="Email"></div>
<div class="step"><h2>Case details</h2>
<label>Case reference number</label><input name="Case number">
<label>Date of judgment</label><input type="date" name="Judgment date">
<label>Court city</label><input name="Court city"></div>
<div class="step"><h2>Language and regulations</h2>
<label>Language understood</label><input name="Language">
<label>Have you received the regulations?</label>
<select name="Regulations"><option>YES</option><option>NO</option></select></div>
<div class="step"><h2>Prisons and cells</h2>
<p><strong>Describe the first prison and the first cell.</strong></p>
<div id="prisons"></div>
<button type="button" id="addFirstBtn" onclick="addFirstPrison()">➕ Describe first prison and cell</button>
<button type="button" id="addNextBtn" onclick="addPrison()" style="display:none">➕ Add another prison</button></div>
<div class="step"><h2>Final preview</h2>
<div class="preview" id="preview"></div>
<button type="button" onclick="downloadTXT()">Download and save</button>
<button type="button" onclick="copyText()">Copy content</button></div>
<div style="margin-top:20px">
<button type="button" onclick="prev()">Back</button>
<button type="button" onclick="next()">Next</button></div>
</form></div>
<script>
let step=0,hasCell=false;const steps=document.querySelectorAll('.step');
function showStep(){steps.forEach((s,i)=>s.classList.toggle('active',i===step));
document.getElementById('progressBar').style.width=((step+1)/steps.length*100)+'%';
if(step===steps.length-1)buildPreview();}
function next(){if(step===4&&!hasCell){alert("You must describe at least one cell.");return;}
if(step<steps.length-1)step++;showStep();}
function prev(){if(step>0)step--;showStep();}
function addFirstPrison(){addPrison();addFirstBtn.style.display='none';addNextBtn.style.display='inline-block';}
function addPrison(){
const d=document.createElement('div');d.className='box';
d.innerHTML=`<h3>Prison</h3>
<label>Prison name</label><input name="Prison">
<label>Period of stay (from – to)</label>
<input type="date" name="Stay from"><input type="date" name="Stay to">
<div class="cells"></div>
<button type="button" onclick="addCell(this)">+ Add another cell (max 4)</button>`;
prisons.appendChild(d);addCell(d.querySelector('button'));}
function addCell(btn){
const cells=btn.parentElement.querySelector('.cells');
if(cells.children.length>=4){alert("Maximum 4 cells.");return;}
hasCell=true;
const c=document.createElement('div');c.className='box';
c.innerHTML=`<h4>Cell ${cells.children.length+1}</h4>
<label>Cell number</label><input name="Cell number">
<label>Number of inmates</label><input name="Number of inmates">
<label>Area</label><input name="Area">
<label>Unit</label><input name="Unit">
<label>Cell layout</label><textarea name="Layout"></textarea>`;
cells.appendChild(c);}
function buildPreview(){
const data=new FormData(form);let t='';
for(let[k,v]of data.entries())t+=k+': '+v+'\n';
preview.textContent=t;}
function downloadTXT(){
const b=new Blob([preview.textContent],{type:"text/plain"});
const a=document.createElement("a");a.href=URL.createObjectURL(b);
a.download="detention_form.txt";a.click();}
function copyText(){navigator.clipboard.writeText(preview.textContent);alert("Content copied.");}
showStep();
</script>
</body></html>
