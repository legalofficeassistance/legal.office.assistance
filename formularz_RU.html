<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Форма – данные о заключении</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 700px;
  margin: 20px auto;
  background: #fff;
  padding: 20px;
  border-radius: 6px;
}
h2 { margin-top: 0; }
.step { display: none; }
.step.active { display: block; }
label { display: block; margin-top: 12px; font-weight: bold; }
input, textarea, select { width: 100%; padding: 8px; margin-top: 4px; }
textarea { min-height: 80px; }
.buttons { margin-top: 20px; display: flex; justify-content: space-between; flex-wrap: wrap; gap:10px; }
button { padding: 10px 16px; cursor: pointer; }
.progress { height: 8px; background: #ddd; border-radius: 4px; margin-bottom: 20px; }
.progress-bar { height: 8px; background: #4caf50; width: 0%; border-radius: 4px; }
.box { border: 1px solid #ccc; padding: 12px; margin-top: 15px; border-radius: 4px; }
.preview { background: #f9f9f9; padding: 10px; white-space: pre-wrap; }
</style>
</head>

<body>
<div class="container">

<div class="progress">
  <div class="progress-bar" id="progressBar"></div>
</div>

<form id="form">

<!-- ШАГ 1 -->
<div class="step active">
  <h2>Личные данные</h2>
  <label>Имя</label><input name="Имя">
  <label>Фамилия</label><input name="Фамилия">
  <label>Период пребывания в тюрьме (с – по)</label>
  <input type="date" name="Период от"><input type="date" name="Период до">
  <label>Адрес проживания</label><textarea name="Адрес"></textarea>
</div>

<!-- ШАГ 2 -->
<div class="step">
  <h2>Контакт и идентификация</h2>
  <label>Номер телефона</label><input name="Телефон">
  <label>Электронная почта</label><input type="email" name="Email">
  <label>Налоговый номер в Словении (Davčna številka)</label><input name="NIP">
  <label>Персональный идентификационный номер EMŠO</label><input name="EMSO">
</div>

<!-- ШАГ 3 -->
<div class="step">
  <h2>Данные судебного дела</h2>
  <label>Номер судебного дела</label><input name="Дело">
  <label>Дата вынесения приговора</label><input type="date" name="Дата приговора">
  <label>Город суда</label><input name="Город суда">
</div>

<!-- ШАГ 4 -->
<div class="step">
  <h2>Язык и права</h2>
  <label>Понятный вам язык</label><input name="Язык">
  <label>Получали ли вы тюремный регламент на понятном вам языке?</label>
  <select name="Регламент"><option>ДА</option><option>НЕТ</option></select>
  <label>Дополнительные замечания</label><textarea name="Замечания"></textarea>
</div>

<!-- ШАГ 5 -->
<div class="step">
  <h2>Тюрьмы и камеры</h2>
  <div id="prisons"></div>
  <button type="button" onclick="addPrison()">+ Добавить другую тюрьму</button>
</div>

<!-- ШАГ 6 -->
<div class="step">
  <h2>Предварительный просмотр</h2>
  <div class="preview" id="preview"></div>
  <label><input type="checkbox" required> Подтверждаю правильность предоставленных данных</label>
</div>

<div class="buttons">
  <button type="button" onclick="prev()">Назад</button>
  <button type="button" onclick="next()">Далее</button>
</div>

<div class="buttons">
  <button type="button" onclick="window.print()">Печать / Сохранить как PDF</button>
  <button type="button" onclick="downloadTXT()">Скачать файл</button>
  <button type="button" onclick="copyText()">Скопировать текст</button>
</div>

</form>
</div>

<script>
let step = 0;
const steps = document.querySelectorAll('.step');
function showStep(){steps.forEach((s,i)=>s.classList.toggle('active',i===step));document.getElementById('progressBar').style.width=((step+1)/steps.length*100)+'%';if(step===steps.length-1) buildPreview();}
function next(){if(step<steps.length-1) step++;showStep();}
function prev(){if(step>0) step--;showStep();}

function addPrison(){
  const div=document.createElement('div'); div.className='box';
  div.innerHTML=`
    <h3>Тюрьма</h3>
    <label>Название / город</label><input name="Тюрьма">
    <label>Номер камеры</label><input name="Камера">
    <label>Количество человек в камере</label><input name="Количество">
    <label>Площадь камеры (примерно)</label><input name="Площадь">
    <label>Описание расположения камеры</label><textarea name="Схема"></textarea>
  `;
  document.getElementById('prisons').appendChild(div);
}

function buildPreview(){
  const data=new FormData(document.getElementById('form'));
  let text='';
  for(let [k,v] of data.entries()){text+=k+': '+v+'\n';}
  document.getElementById('preview').textContent=text;
}
showStep();

function downloadTXT(){
  const text=document.getElementById("preview").textContent;
  const blob=new Blob([text],{type:"text/plain;charset=utf-8"});
  const link=document.createElement("a");
  link.href=URL.createObjectURL(blob);
  link.download="formularz_osadzenie.txt";
  link.click();
}
function copyText(){
  const text=document.getElementById("preview").textContent;
  navigator.clipboard.writeText(text).then(()=>{alert("Текст скопирован. Можете вставить в сообщение или email.");});
}
</script>

</body>
</html>
